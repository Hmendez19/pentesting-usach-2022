#!/bin/bash

function renderizar_menu_principal(){
    pausa
    clear
    menu_principal
}

function listar_aplicaciones(){
    clear
    salto_linea
    echo "$DIBUJAR_LINEA"
    echo "$TITULO_LISTA_APP"
    echo "$DIBUJAR_LINEA"
    declare -a arreglo_lista_app=("$BWAPP_NAME" "$WEBGOAT7_NAME" "$WEBGOAT78_NAME" "$WEBGOAT78_1_NAME" "$DVWA_NAME" "$MUTILLIDAE_NAME" )

    for val in "${arreglo_lista_app[@]}"; do
        echo $val
    done
    echo "$DIBUJAR_LINEA"
    salto_linea
    renderizar_menu_principal
}


function iniciar_aplicacion(){
    clear
    ayuda_menu
    echo "$INICAR_APLICACION"
    echo "$DIBUJAR_LINEA"
    opciones_app=("$BWAPP_NAME" "$WEBGOAT7_NAME" "$WEBGOAT78_NAME" "$WEBGOAT78_1_NAME" "$DVWA_NAME" "$MUTILLIDAE_NAME" "$MENU_ANTERIOR")
    elegir_opcion_menu "Seleccione una aplicacion:" opt "${opciones_app[@]}"
    case $opt in
        "$BWAPP_NAME")
            sudo docker run  -d -p 127.5.0.1:80:80 --name bwapp raesene/bwapp
            agregar_host "127.5.0.1" "bwapp"
            ;;
        "$WEBGOAT7_NAME")
            sudo docker run  -d -p 127.6.0.1:80:80 --name webgoat7 webgoat/webgoat-7.1
            agregar_host "127.6.0.1" "webgoat7"
            ;;
        "$WEBGOAT78_NAME")
            sudo docker run  -d -p 127.7.0.1:80:80 --name webgoat8 vwebgoat/webgoat-8.0
            agregar_host "127.7.0.1" "webgoat8"
            ;;
        "$WEBGOAT78_1_NAME")
            sudo docker run  -d -p 127.17.0.1:80:80 --name webgoat81 webgoat/goatandwolf
            agregar_host "127.17.0.1" "webgoat81"
            ;;
        "$DVWA_NAME")
            sudo docker run  -d -p 127.8.0.1:80:80 --name dvwa vulnerables/web-dvwa
            agregar_host "127.8.0.1" "dvwa"
            ;;
        "$MUTILLIDAE_NAME")
            sudo docker run  -d -p 127.9.0.1:80:80 --name mutillidae citizenstig/nowasp
            agregar_host "127.9.0.1" "mutillidae"
            ;;
    esac
    renderizar_menu_principal
}


function detener_aplicacion(){
    clear
    ayuda_menu
    echo "$DETENER_APLICACION"
    echo "$DIBUJAR_LINEA"
    opciones_app=("$BWAPP_NAME" "$WEBGOAT7_NAME" "$WEBGOAT78_NAME" "$WEBGOAT78_1_NAME" "$DVWA_NAME" "$MUTILLIDAE_NAME" "$MENU_ANTERIOR")
    elegir_opcion_menu "Seleccione una aplicacion:" opt "${opciones_app[@]}"
    case $opt in
        "$BWAPP_NAME")
            sudo docker stop bwapp
            echo "Deteniendo contenendor bwapp"
            ;;
        "$WEBGOAT7_NAME")
            sudo docker stop webgoat7
            echo "Deteniendo contenendor webgoat7"
            ;;
        "$WEBGOAT78_NAME")
            sudo docker stop webgoat8
            echo "Deteniendo contenendor webgoat8"
            ;;
        "$WEBGOAT78_1_NAME")
            sudo docker stop webgoat81
            echo "Deteniendo contenendor webgoat81"
            ;;
        "$DVWA_NAME")
            sudo docker stop dvwa
            echo "Deteniendo contenendor dvwa"
            ;;
        "$MUTILLIDAE_NAME")
            sudo docker stop mutillidae
            echo "Deteniendo contenendor mutillidae"
            ;;
    esac
    renderizar_menu_principal
}